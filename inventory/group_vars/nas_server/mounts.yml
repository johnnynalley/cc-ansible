# =============================================================================
# NAS Server - Filesystem Mounts (Physical Drives + Bind Mounts)
# =============================================================================
# Portable: drives and bind mounts travel with the NAS role.
# If migrating to new hardware with the same drives, UUIDs stay the same.
# ZFS drives (nas_zfs, media-01, media-02) are managed by ZFS, NOT listed here.
# media-03 is ext4 on USB-SATA â€” managed here (ZFS over USB risks pool faults on disconnect).

filesystem_mounts:
  # --- Physical Drives ---

  # 2TB Lacie SSD (ext4) - media storage + SABnzbd incomplete downloads
  - path: /srv/nas-01
    src: "UUID=f356a268-d53b-41fa-95a7-3df47c1c22bc"
    fstype: ext4
    opts: "noatime,nofail,x-systemd.device-timeout=5s"
    owner: johnny
    group: smbusers
    mode: "2775"

  # 2TB Hitachi HDD via USB-SATA (ext4) - media overflow
  - path: /srv/media-03
    src: "/dev/disk/by-id/ata-Hitachi_HDS723020BLA642_MN1270F32VGU1D-part1"
    fstype: ext4
    opts: "noatime,nofail,x-systemd.device-timeout=5s"

  # LUKS-encrypted drive (ext4 on dm-crypt)
  - path: /srv/nas-02
    src: /dev/mapper/nas02_crypt
    fstype: ext4
    opts: "noatime,nofail"
    owner: johnny
    group: smbusers
    mode: "2775"

  # --- Bind Mounts ---

  # Plex library (bind from mergerfs pool)
  - path: /srv/plex-library
    src: /srv/media/plex
    fstype: none
    opts: "bind,nofail,x-systemd.requires-mounts-for=/srv/media"

  # NAS-ZFS accessible at /mnt/nas-zfs (for Samba shares that reference /mnt paths)
  - path: /mnt/nas-zfs
    src: /srv/nas-zfs
    fstype: none
    opts: "rbind,nofail"
    owner: johnny
    group: johnny

  # NFS export: configs directory
  - path: /srv/exports/configs
    src: /srv/nas-zfs/configs
    fstype: none
    opts: "bind,nofail"

  # NFS export: ansible directory
  - path: /srv/exports/ansible
    src: /srv/nas-zfs/configs/ansible
    fstype: none
    opts: "bind,nofail"
    owner: johnny
    group: johnny
    mode: "0775"

  # SABnzbd incomplete downloads (Lacie SSD fast storage)
  # Source is on the Lacie SSD (/srv/nas-01) but OUTSIDE the mergerfs branch
  # (/srv/nas-01/media/). This keeps download temp files safe from mergerfs-balance.
  - path: /srv/media-downloads
    src: /srv/nas-01/downloads/media-downloads
    fstype: none
    opts: "bind,nofail,x-systemd.requires-mounts-for=/srv/nas-01"
    owner: johnny
    group: johnny
    mode: "0775"
