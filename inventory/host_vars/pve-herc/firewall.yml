# =============================================================================
# pve-herc - Proxmox Node Firewall Configuration
# =============================================================================

pve_node_firewall:
  enable: true
  rules:
    - { type: group, name: "corosync-lan", comment: "Cluster heartbeat" }
    - { action: ACCEPT, iface: vmbr0, proto: tcp, dport: 8006, comment: "Proxmox API (LAN)" }
    - { action: ACCEPT, iface: vmbr0, proto: tcp, dport: 22, comment: "SSH (LAN)" }
    - { action: ACCEPT, iface: tailscale0, proto: tcp, dport: 8006, comment: "Proxmox API (Tailscale)" }
    - { action: ACCEPT, iface: tailscale0, proto: tcp, dport: 22, comment: "SSH (Tailscale)" }
    - { action: ACCEPT, iface: tailscale0, proto: icmp, comment: "Ping (Tailscale)" }
    - { action: DROP, comment: "Default deny" }

# VM/CT firewall rules
pve_vm_firewalls:
  # pbs-lxc (CT 105) - Proxmox Backup Server
  105:
    enable: true
    policy_in: DROP
    rules:
      - { action: ACCEPT, proto: tcp, dport: 22, comment: "SSH" }
      - { action: ACCEPT, proto: tcp, dport: 8007, comment: "PBS API/Web UI" }
